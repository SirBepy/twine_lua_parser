window.storyFormat({
  "name": "twine_lua_parser",
  "version": "0.0.4",
  "author": "SirBepy",
  "description": "Export your Twine 2 story as a lua file (RobloxStudio)",
  "proofing": false,
  "source": "<html>\r\n  <head>\r\n    <title>{{STORY_NAME}}</title>\r\n    <script type=\"text/javascript\">\r\n      var{keys:a}=Object,{isArray:b}=Array,c=A=>{const _=typeof A;if(A==null)return null;if(b(A)){const B=A.map(c).join(', ');return`{${B}}`}switch(_) {case 'number':case 'boolean':return`${A}`;case 'string':return`\"${A}\"`;case 'object':{const C=Object.entries(A).map(([_a,_b])=>`${_a} = ${c(_b)}`).join(', ');return`{${C}}`}default:throw Error(`Unsupported data type: ${_}`)}},d=D=>`return ${c(D)}`,e={};e.extractResponsesFromText=_A=>{var _B=_A.match(/\\[\\[.+?\\]\\]/g);if(!_B)return null;return _B.map(E=>{var aA=E.match(/\\[\\[(.*?)\\-\\&gt;(.*?)\\]\\]/);if(aA)return{response:aA[1],link:aA[2]};E=E.substring(2,E.length-2);return{response:E,link:E}})};e.extractPropsFromText=aB=>{var aC={};aB.text=aB.text.replace(/\\(set:\\s*\\$(\\w+)\\s*to\\s*\"([^\"]+)\"\\)/g,(aD,aE,_c)=>{aC[aE]=_c;return''});aB.text=aB.text.trim();return a(aC).length>0?aC:null};e.convertPassage=aF=>{var aG={text:aF.innerHTML},_C=e.extractResponsesFromText(aG.text),_d=e.extractPropsFromText(aG);_C&&(aG.responses=_C);_d&&(aG.props=_d);for(const aH of ['name','pid','tags']){var _e=aF.attributes[aH].value;_e&&(aG[aH]=_e)}aG.tags&&(aG.tags=aG.tags.split(' '));return aG};e.convertStory=aI=>{var aJ=Array.prototype.slice.call(aI.getElementsByTagName('tw-passagedata')).map(e.convertPassage),aK={passages:aJ},_E={};for(const aL of ['name','startnode']){var _D=aI.attributes[aL].value;_D&&(aK[aL]=_D)}for(const aM of aK.passages)_E[aM.name]=aM.pid;for(const aN of aK.passages){if(!aN.responses)continue;for(const aO of aN.responses)aO.pid=_E[aO.link]}return aK};e.init=()=>document.getElementById('output').innerHTML=d(e.convertStory(document.getElementsByTagName('tw-storydata')[0]));window.twine_lua_parser=e;\r\n    </script>\r\n  </head>\r\n  <body>\r\n    <pre id=\"output\"></pre>\r\n    <div id=\"storyData\" style=\"display: none;\">\r\n      {{STORY_DATA}}\r\n    </div>\r\n    <script>\r\n      twine_lua_parser.init();\r\n    </script>\r\n  </body>\r\n</html>\r\n"
});