window.storyFormat({
  "name": "twine_lua_parser",
  "version": "0.0.5",
  "author": "SirBepy",
  "description": "Export your Twine 2 story as a lua file (RobloxStudio)",
  "proofing": false,
  "source": "<html>\r\n  <head>\r\n    <title>{{STORY_NAME}}</title>\r\n    <script type=\"text/javascript\">\r\n      var{keys:a}=Object,{isArray:b}=Array,c=A=>{const _=typeof A;if(A==null)return null;if(b(A)){const B=A.map(c).join(', ');return`{${B}}`}switch(_) {case 'number':case 'boolean':return`${A}`;case 'string':return JSON.stringify(A).replace(/\\\\n\\s+/g,'\\\\n').replace(/\\s+\\\\n/g,'\\\\n');case 'object':{const C=Object.entries(A).map(([_a,_b])=>`${_a} = ${c(_b)}`).join(', ');return`{${C}}`}default:throw Error(`Unsupported data type: ${_}`)}},d=D=>`return ${c(D)}`,e={};e.extractResponsesFromText=_A=>{var _B=_A.text,_c=_B.match(/\\[\\[.+?\\]\\]/g);if(!_c)return null;_A.text=_A.text.replace(/\\[\\[.*?\\]\\]/g,'');return _c.map(E=>{var aA=E.replace(/^\\[+|\\]+$/g,''),[_C,_d]=aA.split('|');return{isDone:_C.startsWith('---'),response:_C.replace(/^---\\s*/,''),link:_d??_C}})};e.extractPropsFromText=aB=>{var aC={};aB.text=aB.text.replace(/\\$(\\w+)\\s*=\\s*(\"[^\"]+\"|\\d+)/g,(aD,aE,aF)=>{aC[aE]=aF;return''});aB.text=aB.text.trim();return a(aC).length>0?aC:null};e.convertPassage=aG=>{var aH={text:aG.innerHTML},aI=e.extractResponsesFromText(aH),_D=e.extractPropsFromText(aH);aI&&(aH.responses=aI);_D&&(aH.props=_D);for(const aJ of ['name','pid','tags']){var _e=aG.attributes[aJ].value;_e&&(aH[aJ]=_e)}aH.tags&&(aH.tags=aH.tags.split(' '));aH.text=aH.text.replace(/\\s+$/g,'');return aH};e.convertStory=aK=>{var aL=Array.prototype.slice.call(aK.getElementsByTagName('tw-passagedata')).map(e.convertPassage),aM={passages:aL},_E={};for(const aO of ['name','startnode']){var aN=aK.attributes[aO].value;aN&&(aM[aO]=aN)}for(const aP of aM.passages)_E[aP.name]=aP.pid;for(const aQ of aM.passages){if(!aQ.responses)continue;for(const aR of aQ.responses)aR.pid=_E[aR.link]}return JSON.parse(JSON.stringify(aM))};e.init=()=>document.getElementById('output').innerHTML=d(e.convertStory(document.getElementsByTagName('tw-storydata')[0]));typeof window!=='undefined'&&(window.twine_lua_parser=e);export{e as twine_lua_parser};\r\n    </script>\r\n  </head>\r\n  <body>\r\n    <pre id=\"output\"></pre>\r\n    <div id=\"storyData\" style=\"display: none;\">\r\n      {{STORY_DATA}}\r\n    </div>\r\n    <script>\r\n      twine_lua_parser.init();\r\n    </script>\r\n  </body>\r\n</html>\r\n"
});